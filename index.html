<!-- ﻿<!doctype html>
<html>
<head>
<meta charset=utf-8 />
<title>Mario Cre PhucPhamXuan</title>
<link href="Content/style.css" rel="stylesheet" />
</head>
<body>
<a href="https://fb.com/phucpham.08"><img src="https://www.bing.com/th?id=AMMS_928a62c96ba821e882cb080907bbb897&w=110&h=110&c=7&rs=1&qlt=95&pcl=f9f9f9&o=6&cdv=1&pid=16.1" width="40" height="39.78"></a>
  <a>Liên hệ hợp tác</a>
<div id="game">
<div id="world">
</div>
<div id="coinNumber" class="gauge">0</div>
<div id="coin" class="gaugeSprite"></div>
<div id="liveNumber" class="gauge">0</div>
<div id="live" class="gaugeSprite"></div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="Scripts/jQuery.js"><\/script>')</script>
<script src="Scripts/testlevels.js"></script>
<script src="Scripts/oop.js"></script>
<script src="Scripts/keys.js"></script>
<script src="Scripts/constants.js"></script>
<script src="Scripts/main.js"></script>
</body>
</html>
 -->
 <!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Biểu đồ lượt truy cập realtime</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 50px;
    }
    canvas {
      max-width: 800px;
      margin: auto;
    }
  </style>
</head>
<body>
  <h1>Lượt truy cập realtime</h1>
  <canvas id="visitorChart" width="800" height="400"></canvas>

  <script>
    const namespace = "demo_vietcode";
    const key = "homepage";
    const fetchURL = `https://api.countapi.xyz/hit/${namespace}/${key}`;

    const ctx = document.getElementById('visitorChart').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Lượt truy cập',
          data: [],
          borderColor: 'rgba(75, 192, 192, 1)',
          backgroundColor: 'rgba(75, 192, 192, 0.2)',
          tension: 0.2
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: {
            type: 'time',
            time: {
              unit: 'second'
            },
            title: {
              display: true,
              text: 'Thời gian'
            }
          },
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'Lượt truy cập'
            }
          }
        }
      }
    });

    function updateChart() {
      fetch(fetchURL)
        .then(res => res.json())
        .then(data => {
          const now = new Date();
          chart.data.labels.push(now);
          chart.data.datasets[0].data.push(data.value);

          if (chart.data.labels.length > 20) {
            chart.data.labels.shift();
            chart.data.datasets[0].data.shift();
          }

          chart.update();
        })
        .catch(err => console.error('Lỗi khi fetch:', err));
    }

    // Cập nhật mỗi 5 giây
    updateChart(); // lần đầu tiên
    setInterval(updateChart, 5000);
  </script>
</body>
</html>
